RewriteEngine On

# Wedos subdomains (with or without www on the start)
RewriteCond %{REQUEST_URI} !^subdom/
RewriteCond %{REQUEST_URI} !^/subdom/
RewriteCond %{HTTP_HOST} ^(www\.)?(.*)\.([^\.]*)\.([^\.]*)$
RewriteCond %{DOCUMENT_ROOT}/subdom/%2 -d
RewriteRule (.*) subdom/%2/$1 [DPI]

# Wedos subdomains (redirect when / missing)
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^subdom/[^/]+/(.+[^/])$ /$1/ [R]

###
### Rewrite www.domain.com -> domain.com
###
RewriteCond %{HTTP_HOST} .
RewriteCond %{HTTP_HOST} !^(2017\.|2018\.)?prazskybarcamp\.cz [NC]
RewriteRule .? https://prazskybarcamp.cz%{REQUEST_URI} [R=301,L]

## Wedos Hack
RewriteCond %{HTTP_HOST} ^prazskybarcamp\.cz [NC]
RewriteRule (.*) www/$1
# Wedos Hack